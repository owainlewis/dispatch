dispatch:
  server:
    port: 8080
    ssl:
      enabled: true
      keystore: /etc/ssl/dispatch/keystore.p12
      keystore-password: ${KEYSTORE_PASSWORD}
  
  filters:
    - name: logging
      enabled: true
      config:
        level: INFO
        include-body: false
        include-headers: false
    
    - name: header-transformer
      enabled: true
      config:
        request:
          add:
            X-Request-ID: "auto-generated"
            X-Forwarded-Proto: "https"
          remove:
            - "X-Internal-Secret"
            - "X-Debug-Info"
        response:
          add:
            X-Powered-By: "Dispatch Gateway v1.0"
            X-Content-Type-Options: "nosniff"
            X-Frame-Options: "DENY"
            X-XSS-Protection: "1; mode=block"
          remove:
            - "Server"
    
    - name: authentication
      enabled: true
      config:
        type: bearer-token
        provider: jwt
        skip-paths: 
          - "/health"
          - "/health/ready"
          - "/health/live"
          - "/public/*"
          - "/docs/*"
        jwt:
          secret: ${JWT_SECRET}
          issuer: "dispatch-gateway"
    
    - name: rate-limiting
      enabled: true
      config:
        requests-per-minute: 1000
        burst-capacity: 50
        key-type: user-id
    
    - name: proxy
      enabled: true
      config:
        connect-timeout: 5
        request-timeout: 30
        max-retries: 3
        load-balancer: round-robin
        routes:
          routes:
            # User service with multiple instances
            - path: "/api/v1/users/*"
              backend: 
                - "http://user-service-1:8080"
                - "http://user-service-2:8080"
                - "http://user-service-3:8080"
              strip-prefix: "/api/v1"
              add-prefix: "/users"
              enabled: true
            
            # Order service
            - path: "/api/v1/orders/*"
              backend: "http://order-service:8080"
              strip-prefix: "/api/v1"
              enabled: true
            
            # Product catalog service
            - path: "/api/v1/products/*"
              backend: 
                - "http://catalog-service-1:8080"
                - "http://catalog-service-2:8080"
              strip-prefix: "/api/v1"
              enabled: true
            
            # Payment service (single instance)
            - path: "/api/v1/payments/*"
              backend: "http://payment-service:8080"
              strip-prefix: "/api/v1"
              enabled: true
            
            # Analytics service (read-only)
            - path: "/api/v1/analytics/*"
              backend: "http://analytics-service:8080"
              strip-prefix: "/api/v1"
              enabled: true